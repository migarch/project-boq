<mat-card class="main-card">
    <mat-card-header class="main-header">
        <mat-card-title>
            {{ProjectName}}
        </mat-card-title>
        <mat-card-subtitle>
            Proejct Details
        </mat-card-subtitle>
        
    </mat-card-header>
    <mat-card-content>
        <div style="width: 100%; display: inline-flex; position: relative;">
        <div class="width-25">
            <mat-card class="bulding-card">
                <mat-card-header>
                <mat-card-subtitle class="inner-subtitle">
                    <div class="containerX">
                        <div class="container">
                            <div class="copyButton">
                                <button mat-raised-button mat-button color="primary" (click)="toggleAdd('addDiv')">
                                    <mat-icon>add</mat-icon>
                                </button>
                            </div>
                        </div>
                    </div>
                </mat-card-subtitle>
                </mat-card-header>
                <div [@slideInOut]="animationState" class="addDiv" >
                    <form [formGroup]="addBulding" (ngSubmit)="sendBuildingData()">
                        <mat-form-field class="width-50">
                            <mat-label>Building Sortcode</mat-label>
                            <input matInput type="text" formControlName="BuildingShortCode" placeholder="">
                        </mat-form-field>
                        <mat-form-field class="width-50 ml-2">
                            <mat-label>Building Name</mat-label>
                            <input matInput type="text" formControlName="BuildingName" placeholder="">
                            <mat-error>Required</mat-error>
                        </mat-form-field>
                        <span class="b-add-button">
                            <button [disabled]="!this.addBulding.valid" align="end" mat-button mat-raised-button color="primary">Insert</button>
                            <button class="cancelButton" mat-button mat-raised-button color="cancel" (click)="reset()">Cancel</button>
                        </span>
                    </form>
                </div>
                <mat-card-content>
                    <mat-selection-list class="bulding-select" #shoes [multiple]="false" (selectionChange)="getBuildingList($event)">
                        <mat-list-option class="bulding-list" *ngFor="let building of buildingDetails; let i = index" [value]="building.id">
                        <span>
                            <span *ngIf="!building.canEditCode">
                            <span>{{building.BuildingShortCode}}</span> |
                            <span>{{building.BuildingName}}</span>
                            </span>
                            <span *ngIf="building.canEditCode">
                            <input [(ngModel)]="building.BuildingShortCode" type="text" class="form-control" style="width: 25%;" /> |
                            <input [(ngModel)]="building.BuildingName" type="text" class="form-control" />
                            </span>
                        </span>
                        <span class="option-button">
                                <mat-hint>
                                    <mat-icon *ngIf="!building.canEditCode" style="color: green;" (click)="building.canEditCode = true">edit</mat-icon>
                                    <mat-icon *ngIf="building.canEditCode" (click)="updateBuilding(building)" style="color: green;">done</mat-icon>
                                    <mat-icon *ngIf="!building.canEditCode" (click)="deleteBuilding(i)" style="color: red;">delete</mat-icon>
                                    <mat-icon *ngIf="building.canEditCode" (click)="cancelEdit(building)" style="color: red;">clear</mat-icon>
                                </mat-hint>
                        </span>
                        </mat-list-option>
                        
                    </mat-selection-list>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="width-25">
            <mat-card class="items-card">
                <mat-card-header>
                    <mat-card-subtitle class="inner-subtitle">
                        <div class="containerX">
                            <div class="container">
                                <div class="copyButton">
                                    <button [disabled]="!disabledAddItem" mat-raised-button mat-button color="primary" (click)="toggleAdd('addDiv2')">
                                        <mat-icon>add</mat-icon>
                                    </button>
                                    <button class="ml-2" [disabled]="!disabledAddItem" (click)="slectAndItems('Select',{})" mat-raised-button mat-button color="primary">
                                        <mat-icon>content_copy</mat-icon>
                                    </button>
                                </div>
                                <div class="conf-seq">
                                        <select class="select-confi" [disabled]="disabledSequence" matTooltip="Select items sequence" matTooltipPosition="above" matNativeControl #sel (change)="itemSequence($event)">
                                            <option  *ngFor="let option of sequenceItem" [value]="option.value"
                                            [selected]="selectedItem === option.value">{{ option.viewValue }}</option>
                                        </select>
                                </div>
                                
                            </div>
                        </div>
                    </mat-card-subtitle>
                </mat-card-header>
                <div [@slideInOut]="animationState2" class="addDiv2" >
                    <form [formGroup]="addItems" (ngSubmit)="sendItemsData()">
                        <mat-form-field class="width-100">
                            <mat-label>Item Name</mat-label>
                            <input matInput type="text" formControlName="ItemsName" placeholder="Item Name">
                        </mat-form-field>
                        <button [disabled]="this.addItems.invalid" align="end" mat-button mat-raised-button color="primary">Insert</button>
                        <button class="cancelButton" mat-button mat-raised-button (click)="reset2()">Cancel</button>
                    </form>
                </div>
                <mat-card-content>
                    <mat-selection-list class="bulding-select" class="" #item [multiple]="false" (selectionChange)="getItemId($event)">
                        <mat-list-option class="bulding-list" *ngFor="let items of buildingItem" [value]="items.id">
                            <span>({{items.ItemShortCode}}) <span *ngIf="!items.canEditCode">{{items.ItemName}}</span>
                                                            <span *ngIf="items.canEditCode"><input contenteditable="true" [(ngModel)]="items.ItemName" type="text" /></span>
                            </span>
                            <span class="option-button">
                                <mat-hint>
                                    <mat-icon *ngIf="!items.canEditCode" style="color: green;" (click)="items.canEditCode = true">edit</mat-icon>
                                    <mat-icon *ngIf="items.canEditCode" (click)="updateItem(items)" style="color: green;">done</mat-icon>
                                    <mat-icon *ngIf="!items.canEditCode" (click)="deleteItem(i)" style="color: red;">delete</mat-icon>
                                    <mat-icon *ngIf="items.canEditCode" (click)="cancelItem(items)" style="color: red;">clear</mat-icon>
                                </mat-hint>
                        </span>
                        </mat-list-option>
                    </mat-selection-list>
                </mat-card-content>
            </mat-card>
        </div>
        <div class="width-50" style="width: 50%;">
            <mat-card class="itemlist-card">
                <mat-card-header>
                    <mat-card-subtitle class="inner-subtitle">
                        <div class="containerX">
                            <div class="container">
                                <div class="copyButton">
                                    <button [disabled]="" mat-raised-button mat-button color="primary">
                                        <mat-icon>add</mat-icon>
                                    </button>
                                    <button [disabled]="!disabledCopyLineItem" (click)="slecetAndLineItems('Select',{})" class="ml-2" mat-raised-button mat-button color="primary">
                                        <mat-icon>content_copy</mat-icon>
                                    </button>
                                </div>
                                <div class="conf-seq">
                                    <select class="select-confi" matTooltip="Select items sequence" matTooltipPosition="above" matNativeControl #sel (change)="lineitemSequence($event)">
                                        <option  *ngFor="let option of sequenceLineItem" [value]="option.value"
                                        [selected]="selectedLineItem === option.value">{{ option.viewValue }}</option>
                                        
                                    </select>
                            </div>
                            </div>
                        </div>
                    </mat-card-subtitle>
                </mat-card-header>
                
                <mat-card-content>
                    <!-- mat table -->
                    <table mat-table [dataSource]="dataSource" #outerSort="matSort"  multiTemplateDataRows class="mat-elevation-z8" matSort>
                        <ng-container matColumnDef="{{column}}" *ngFor="let column of columnsToDisplay">
                            <ng-container *ngIf="column !== 'IsSubLineItem'; else IsSubLineItem">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> {{column}} </th>
                            <td mat-cell *matCellDef="let element"> {{element[column]}} </td>
                            </ng-container>
                            <ng-template #IsSubLineItem>
                                <th mat-header-cell *matHeaderCellDef> Sub Items </th>
                                <td mat-cell *matCellDef="let element">
                                  <mat-icon
                                  (click)="expandedElement = expandedElement === element ? null : element" >
                                  {{expandedElement === element ? 'expand_less' : 'expand_more'}}</mat-icon>
                                </td>
                            </ng-template>
                        </ng-container>
                        
                        <!-- Expanded Content -->
                        <ng-container matColumnDef="expandedDetail">
                            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                                <div class="example-element-detail" *ngIf="element.sublineitems?.data.length" 
                                [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                                    <div class="inner-table mat-elevation-z8" *ngIf="expandedElement">
                                        
                                        <table #innerTables mat-table #innerSort="matSort" [dataSource]="element.sublineitems" matSort>
                                            <ng-container matColumnDef="{{innerColumn}}" *ngFor="let innerColumn of innerDisplayedColumns">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> {{innerColumn}} </th>
                                            <td mat-cell *matCellDef="let element"> {{element[innerColumn]}}</td>
                                            </ng-container>
                                            <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                                            <tr mat-row *matRowDef="let row; columns: innerDisplayedColumns;"></tr>
                                        </table>
                                    </div>
                                </div>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                        <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" [class.example-element-row]="element.sublineitems?.data.length"
                        [class.example-expanded-row]="expandedElement === element" (click)="toggleRow(element)">
                        </tr>
                        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
                    </table>
                </mat-card-content>
            </mat-card>
        </div>
        </div>

    </mat-card-content>
 </mat-card>
  